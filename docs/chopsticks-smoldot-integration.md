# Chopsticks + Smoldot: Chain Forking Deep Dive

## What Happens When Chopsticks Forks a Chain

When Chopsticks forks a blockchain, it creates a **local parallel reality** that diverges from the live chain at a specific block. This process relies heavily on Smoldot's core components to ensure execution fidelity.

### The Fork Process Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Chopsticks Fork Process                       â”‚
â”‚                                                                  â”‚
â”‚  Live Chain Timeline:                                            â”‚
â”‚  Block 1000 â”€â”€â–º Block 1001 â”€â”€â–º Block 1002 â”€â”€â–º Block 1003...     â”‚
â”‚                      â”‚                                           â”‚
â”‚                      â–¼ Fork Point                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Step 1: Initial Connection                     â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    RPC/WS    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚ â”‚
â”‚  â”‚  â”‚ Chopsticks  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Live Chain  â”‚              â”‚ â”‚
â”‚  â”‚  â”‚   Client    â”‚              â”‚   Node      â”‚              â”‚ â”‚
â”‚  â”‚  â”‚             â”‚              â”‚             â”‚              â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Config    â”‚              â”‚ â€¢ Block     â”‚              â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Endpoint  â”‚              â”‚ â€¢ State     â”‚              â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Fork Blockâ”‚              â”‚ â€¢ Runtime   â”‚              â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                      â”‚                                           â”‚
â”‚                      â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚           Step 2: State & Runtime Download                  â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ â”‚
â”‚  â”‚  â”‚   Block     â”‚    â”‚   State     â”‚    â”‚   Runtime   â”‚     â”‚ â”‚
â”‚  â”‚  â”‚ Header/Body â”‚    â”‚   Proofs    â”‚    â”‚ WASM Blob   â”‚     â”‚ â”‚
â”‚  â”‚  â”‚             â”‚    â”‚             â”‚    â”‚             â”‚     â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Hash      â”‚    â”‚ â€¢ Merkle    â”‚    â”‚ â€¢ :code     â”‚     â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Number    â”‚    â”‚ â€¢ Storage   â”‚    â”‚ â€¢ Version   â”‚     â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ StateRoot â”‚    â”‚ â€¢ Trie      â”‚    â”‚ â€¢ Metadata  â”‚     â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                      â”‚                                           â”‚
â”‚                      â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚        Step 3: Smoldot Runtime Initialization              â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  â”‚               WASM Processing                           â”‚ â”‚
â”‚  â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â”‚ 1. Decompress Runtime (Zstd if needed)                 â”‚ â”‚
â”‚  â”‚  â”‚ 2. Parse WASM Module                                   â”‚ â”‚
â”‚  â”‚  â”‚ 3. Validate WASM Format                                â”‚ â”‚
â”‚  â”‚  â”‚ 4. Extract Runtime Exports:                            â”‚ â”‚
â”‚  â”‚  â”‚    â€¢ Core_version                                      â”‚ â”‚
â”‚  â”‚  â”‚    â€¢ Core_execute_block                                â”‚ â”‚
â”‚  â”‚  â”‚    â€¢ BlockBuilder_*                                    â”‚ â”‚
â”‚  â”‚  â”‚    â€¢ RuntimeApi_*                                      â”‚ â”‚
â”‚  â”‚  â”‚ 5. Setup Host Function Imports                         â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                           â”‚                               â”‚ â”‚
â”‚  â”‚                           â–¼                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  â”‚             VM Instantiation                           â”‚ â”‚
â”‚  â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚   Wasmi     â”‚    â”‚    Host     â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ Interpreter â”‚â—„â”€â”€â–ºâ”‚ Functions   â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚             â”‚    â”‚             â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â€¢ Memory    â”‚    â”‚ â€¢ Storage   â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â€¢ Stack     â”‚    â”‚ â€¢ Crypto    â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â€¢ Execution â”‚    â”‚ â€¢ Hashing   â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  â”‚             Runtime Call Testing                       â”‚ â”‚
â”‚  â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â”‚ Test Call: Core_version()                              â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€ Verify: spec_name, spec_version, apis              â”‚ â”‚
â”‚  â”‚  â”‚ â””â”€ Confirm: Runtime is functional                      â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                      â”‚                                           â”‚
â”‚                      â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚          Step 4: Local Chain Initialization                â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ â”‚
â”‚  â”‚  â”‚   SQLite    â”‚    â”‚   Memory    â”‚    â”‚   RPC       â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  Database   â”‚    â”‚   Cache     â”‚    â”‚  Server     â”‚     â”‚ â”‚
â”‚  â”‚  â”‚             â”‚    â”‚             â”‚    â”‚             â”‚     â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Blocks    â”‚    â”‚ â€¢ Storage   â”‚    â”‚ â€¢ ws://8000 â”‚     â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ State     â”‚    â”‚ â€¢ Trie      â”‚    â”‚ â€¢ JSON-RPC  â”‚     â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Metadata  â”‚    â”‚ â€¢ Override  â”‚    â”‚ â€¢ Substrate â”‚     â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  Parallel Reality Begins:                                       â”‚
â”‚  Block 1001'â”€â”€â–º Block 1002'â”€â”€â–º Block 1003'... (Local)          â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Specific Smoldot Components Used by Chopsticks

### 1. **Core Execution Engine** (`smoldot::executor`)

**What Chopsticks Uses:**
```rust
use smoldot::{
    executor::{
        host::{Config, HeapPages, HostVmPrototype, LogEmitInfo},
        runtime_call::{self, OffchainContext, RuntimeCall},
        storage_diff::TrieDiff,
        CoreVersionRef,
    },
};
```

**Purpose:**
- **HostVmPrototype**: Creates the WASM virtual machine instance
- **RuntimeCall**: Executes runtime functions like `Core_execute_block`
- **TrieDiff**: Tracks storage changes between blocks
- **CoreVersionRef**: Extracts runtime version information

**How It Works:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Smoldot Executor in Chopsticks                    â”‚
â”‚                                                                  â”‚
â”‚  User Transaction                                                â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Chopsticks RPC Layer                           â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚ â€¢ author_submitExtrinsic                                   â”‚ â”‚
â”‚  â”‚ â€¢ state_call                                               â”‚ â”‚
â”‚  â”‚ â€¢ chain_getBlock                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â”‚                                     â”‚
â”‚                           â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                 Task Orchestration                          â”‚ â”‚
â”‚  â”‚                 (executor/src/task.rs)                     â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  TaskCall {                                                â”‚ â”‚
â”‚  â”‚    wasm: HexString,           // Runtime WASM blob         â”‚ â”‚
â”‚  â”‚    calls: Vec<(String, Vec<HexString>)>, // Runtime calls  â”‚ â”‚
â”‚  â”‚    mock_signature_host: bool, // For testing               â”‚ â”‚
â”‚  â”‚    ...                                                     â”‚ â”‚
â”‚  â”‚  }                                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â”‚                                     â”‚
â”‚                           â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Smoldot VM Execution                           â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  â”‚               VM Setup                                  â”‚ â”‚
â”‚  â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â”‚ let vm = HostVmPrototype::new(Config {                 â”‚ â”‚
â”‚  â”‚  â”‚     module: &wasm_blob,                                â”‚ â”‚
â”‚  â”‚  â”‚     heap_pages: HeapPages::from(1024),                â”‚ â”‚
â”‚  â”‚  â”‚     exec_hint: ExecHint::ValidateAndExecuteOnce,       â”‚ â”‚
â”‚  â”‚  â”‚     allow_unresolved_imports: false,                   â”‚ â”‚
â”‚  â”‚  â”‚ })?;                                                   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                           â”‚                               â”‚ â”‚
â”‚  â”‚                           â–¼                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  â”‚            Runtime Call Execution                      â”‚ â”‚
â”‚  â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â”‚ let mut runtime_call = RuntimeCall::new(vm);           â”‚ â”‚
â”‚  â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â”‚ for (function, parameters) in calls {                  â”‚ â”‚
â”‚  â”‚  â”‚     let result = runtime_call.call(                    â”‚ â”‚
â”‚  â”‚  â”‚         &function,                                      â”‚ â”‚
â”‚  â”‚  â”‚         parameters,                                     â”‚ â”‚
â”‚  â”‚  â”‚         OffchainContext::Disabled                       â”‚ â”‚
â”‚  â”‚  â”‚     )?;                                                 â”‚ â”‚
â”‚  â”‚  â”‚ }                                                       â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                           â”‚                               â”‚ â”‚
â”‚  â”‚                           â–¼                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  â”‚            Result Processing                           â”‚ â”‚
â”‚  â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â”‚ CallResponse {                                         â”‚ â”‚
â”‚  â”‚  â”‚     result: HexString,        // Encoded result       â”‚ â”‚
â”‚  â”‚  â”‚     storage_diff: TrieDiff,   // State changes        â”‚ â”‚
â”‚  â”‚  â”‚     logs: Vec<LogInfo>,       // Runtime logs         â”‚ â”‚
â”‚  â”‚  â”‚ }                                                      â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. **Trie and Proof System** (`smoldot::trie`)

**What Chopsticks Uses:**
```rust
use smoldot::{
    trie::{
        bytes_to_nibbles, nibbles_to_bytes_suffix_extend,
        proof_decode::{decode_and_verify_proof, Config, StorageValue},
        proof_encode::ProofBuilder,
        calculate_root::{root_merkle_value, RootMerkleValueCalculation},
        HashFunction, TrieEntryVersion,
    },
};
```

**Purpose:**
- **Proof Verification**: Validate storage proofs from live chain
- **Trie Construction**: Build local state tries
- **Storage Diff**: Track changes between blocks
- **Root Calculation**: Compute state roots

**Storage Proof Flow:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Storage Proof Processing                        â”‚
â”‚                                                                  â”‚
â”‚  Live Chain                           Chopsticks                 â”‚
â”‚      â”‚                                    â”‚                      â”‚
â”‚      â–¼                                    â–¼                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   Storage Proof    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   Full      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Smoldot     â”‚              â”‚
â”‚  â”‚   Node      â”‚                    â”‚ Proof       â”‚              â”‚
â”‚  â”‚             â”‚                    â”‚ Decoder     â”‚              â”‚
â”‚  â”‚ â€¢ Complete  â”‚                    â”‚             â”‚              â”‚
â”‚  â”‚   State     â”‚                    â”‚ â€¢ Verify    â”‚              â”‚
â”‚  â”‚ â€¢ Merkle    â”‚                    â”‚   Crypto    â”‚              â”‚
â”‚  â”‚   Tree      â”‚                    â”‚ â€¢ Extract   â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚   Values    â”‚              â”‚
â”‚                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                           â”‚                      â”‚
â”‚                                           â–¼                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚            decode_and_verify_proof()                        â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚ 1. Parse encoded proof bytes                               â”‚ â”‚
â”‚  â”‚ 2. Reconstruct trie structure                              â”‚ â”‚
â”‚  â”‚ 3. Verify Merkle paths                                     â”‚ â”‚
â”‚  â”‚ 4. Validate against state root                             â”‚ â”‚
â”‚  â”‚ 5. Extract storage key-value pairs                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                           â”‚                      â”‚
â”‚                                           â–¼                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Verified Storage Data                          â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚ Vec<(key: HexString, value: HexString)>                    â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚ â€¢ Cryptographically guaranteed to be correct               â”‚ â”‚
â”‚  â”‚ â€¢ Can be trusted as authentic chain state                  â”‚ â”‚
â”‚  â”‚ â€¢ Forms basis for local execution                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. **JSON-RPC Infrastructure** (`smoldot::json_rpc`)

**What Chopsticks Uses:**
```rust
use smoldot::{
    json_rpc::methods::{HashHexString, HexString},
};
```

**Purpose:**
- **Data Encoding**: Consistent hex string formatting
- **Type Safety**: Strongly typed hash and hex values
- **RPC Compatibility**: Standard Substrate RPC format

## Why Smoldot is the Perfect Solution for Chopsticks

### 1. **Execution Fidelity**

**The Problem:** Development tools often use simplified or mock execution environments that don't match production behavior.

**Smoldot's Solution:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Execution Fidelity                           â”‚
â”‚                                                                  â”‚
â”‚  Production Chain              Chopsticks + Smoldot             â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚   Runtime   â”‚               â”‚   Runtime   â”‚                  â”‚
â”‚  â”‚ WASM Blob   â”‚â”€â”€â”€Identicalâ”€â”€â–ºâ”‚ WASM Blob   â”‚                  â”‚
â”‚  â”‚             â”‚               â”‚             â”‚                  â”‚
â”‚  â”‚ â€¢ Same Code â”‚               â”‚ â€¢ Same Code â”‚                  â”‚
â”‚  â”‚ â€¢ Same STF  â”‚               â”‚ â€¢ Same STF  â”‚                  â”‚
â”‚  â”‚ â€¢ Same APIs â”‚               â”‚ â€¢ Same APIs â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚         â”‚                               â”‚                       â”‚
â”‚         â–¼                               â–¼                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ Substrate   â”‚               â”‚   Smoldot   â”‚                  â”‚
â”‚  â”‚   Native    â”‚               â”‚ WASM Engine â”‚                  â”‚
â”‚  â”‚ or Wasmtime â”‚               â”‚             â”‚                  â”‚
â”‚  â”‚             â”‚               â”‚ â€¢ Same Host â”‚                  â”‚
â”‚  â”‚ â€¢ Host Fns  â”‚               â”‚   Functions â”‚                  â”‚
â”‚  â”‚ â€¢ Memory    â”‚               â”‚ â€¢ Same Mem  â”‚                  â”‚
â”‚  â”‚ â€¢ Execution â”‚               â”‚   Model     â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚         â”‚                               â”‚                       â”‚
â”‚         â–¼                               â–¼                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚   Result    â”‚â”€â”€â”€Identicalâ”€â”€â–ºâ”‚   Result    â”‚                  â”‚
â”‚  â”‚             â”‚               â”‚             â”‚                  â”‚
â”‚  â”‚ â€¢ State Î”   â”‚               â”‚ â€¢ State Î”   â”‚                  â”‚
â”‚  â”‚ â€¢ Events    â”‚               â”‚ â€¢ Events    â”‚                  â”‚
â”‚  â”‚ â€¢ Logs      â”‚               â”‚ â€¢ Logs      â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Key Benefits:**
- **Bug Detection**: Catches issues that would only appear in production
- **Realistic Testing**: Exact same execution environment as live chains
- **State Transition Accuracy**: Perfect reproduction of runtime logic

### 2. **Resource Efficiency**

**The Problem:** Full Substrate nodes require enormous resources for development.

**Smoldot's Solution:**

| Resource | Full Node | Smoldot | Chopsticks Benefit |
|----------|-----------|---------|-------------------|
| **Storage** | 100GB-1TB | None | Fast setup, no disk space |
| **Memory** | 4-16GB | 50-200MB | Runs on developer laptops |
| **Network** | Full P2P sync | Light proofs only | Quick sync, low bandwidth |
| **CPU** | Consensus overhead | Execution only | Focus on development tasks |
| **Setup Time** | Hours to days | Seconds | Instant development iteration |

### 3. **Cross-Platform Compatibility**

**The Problem:** Blockchain development tools are often platform-specific or require complex setups.

**Smoldot's Solution:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Universal Deployment                           â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   Desktop   â”‚    â”‚   Browser   â”‚    â”‚   Mobile    â”‚          â”‚
â”‚  â”‚             â”‚    â”‚             â”‚    â”‚             â”‚          â”‚
â”‚  â”‚ â€¢ Windows   â”‚    â”‚ â€¢ Chrome    â”‚    â”‚ â€¢ iOS       â”‚          â”‚
â”‚  â”‚ â€¢ macOS     â”‚    â”‚ â€¢ Firefox   â”‚    â”‚ â€¢ Android   â”‚          â”‚
â”‚  â”‚ â€¢ Linux     â”‚    â”‚ â€¢ Safari    â”‚    â”‚ â€¢ React Nat â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚         â”‚                    â”‚                    â”‚             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                              â”‚                                  â”‚
â”‚                              â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    WASM Runtime                             â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚ â€¢ Universal execution environment                           â”‚ â”‚
â”‚  â”‚ â€¢ No platform-specific dependencies                        â”‚ â”‚
â”‚  â”‚ â€¢ Same behavior everywhere                                  â”‚ â”‚
â”‚  â”‚ â€¢ Easy distribution and deployment                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. **Developer Experience Focus**

**The Problem:** Full nodes prioritize network operation over developer needs.

**Smoldot's Chopsticks Optimization:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Developer-Centric Design                         â”‚
â”‚                                                                  â”‚
â”‚  Full Node Priorities          Smoldot + Chopsticks Priorities  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ Network     â”‚               â”‚ Execution   â”‚                  â”‚
â”‚  â”‚ Consensus   â”‚               â”‚ Accuracy    â”‚                  â”‚
â”‚  â”‚ Security    â”‚               â”‚             â”‚                  â”‚
â”‚  â”‚ Reliability â”‚               â”‚ â€¢ Perfect   â”‚                  â”‚
â”‚  â”‚ Scale       â”‚               â”‚   Runtime   â”‚                  â”‚
â”‚  â”‚             â”‚               â”‚ â€¢ Fast      â”‚                  â”‚
â”‚  â”‚ ğŸ”´ Complex   â”‚               â”‚ â€¢ Simple    â”‚                  â”‚
â”‚  â”‚ ğŸ”´ Resource  â”‚               â”‚             â”‚                  â”‚
â”‚  â”‚ ğŸ”´ Slow      â”‚               â”‚ ğŸŸ¢ Light    â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚         â”‚                               â”‚                       â”‚
â”‚         â–¼                               â–¼                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ Production  â”‚               â”‚ Development â”‚                  â”‚
â”‚  â”‚ Validator   â”‚               â”‚ Environment â”‚                  â”‚
â”‚  â”‚             â”‚               â”‚             â”‚                  â”‚
â”‚  â”‚ â€¢ Uptime    â”‚               â”‚ â€¢ Fast Iter â”‚                  â”‚
â”‚  â”‚ â€¢ Security  â”‚               â”‚ â€¢ Easy Test â”‚                  â”‚
â”‚  â”‚ â€¢ Penalties â”‚               â”‚ â€¢ Debug     â”‚                  â”‚
â”‚  â”‚             â”‚               â”‚ â€¢ Experimentâ”‚                  â”‚
â”‚  â”‚ ğŸ¯ Live Net  â”‚               â”‚             â”‚                  â”‚
â”‚  â”‚             â”‚               â”‚ ğŸ¯ Dev Tools â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## The Perfect Match: Why Chopsticks + Smoldot Works

### **Complementary Strengths**

1. **Chopsticks Provides:**
   - Developer tooling and workflow
   - Storage management and caching
   - RPC interface and compatibility
   - Block building and transaction handling
   - XCM simulation and multi-chain testing

2. **Smoldot Provides:**
   - Accurate runtime execution
   - Cryptographic verification
   - WASM virtual machine
   - Proof handling and validation
   - Cross-platform compatibility

### **Shared Philosophy**

Both projects prioritize:
- **Lightweight over Heavy**: Minimal resource usage
- **Accurate over Approximate**: Correct execution behavior
- **Simple over Complex**: Easy developer adoption
- **Universal over Specific**: Cross-platform compatibility

### **The Result**

Chopsticks + Smoldot creates a development environment that is:

âœ… **Realistic**: Uses actual chain runtimes and execution logic  
âœ… **Fast**: Instant setup and rapid iteration  
âœ… **Accessible**: Runs anywhere, no infrastructure required  
âœ… **Reliable**: Cryptographically verified state and proofs  
âœ… **Comprehensive**: Full blockchain simulation for testing  

This combination gives developers **production-level accuracy** with **development-level convenience** - the best of both worlds for building and testing Substrate-based applications.